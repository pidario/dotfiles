#/bin/sh

set -eu

DMENU="$(check-dep wofi)"

menu=$(echo -e 'lock\nlogout\npoweroff\nreboot' | "$DMENU" --show dmenu -p "Choose")

confirm() {
	choice=$(echo -e 'no\nyes' | "$DMENU" --show dmenu -p "Confirm ${1}?")
	if [ "$choice" = "yes" ]; then
		"${1}"
	fi
}

case "$menu" in
	"lock") kill -USR1 $(pidof swayidle);;
	"logout") niri msg action quit;;
	"poweroff"|"reboot") confirm "$menu";;
esac

