#!/bin/sh

set -eu

DMENU="$(check-dep wofi)"

MENU=$(echo -e 'lock\nlogout\npoweroff\nreboot' | "$DMENU" --show dmenu -p "Choose")

confirm() {
	CHOICE=$(echo -e 'no\nyes' | "$DMENU" --show dmenu -p "Confirm ${1}?")
	if [ "$CHOICE" = "yes" ]; then
		"${1}"
	fi
}

case "$MENU" in
	"lock") kill -USR1 $(pidof swayidle);;
	"logout") niri msg action quit;;
	"poweroff"|"reboot") confirm "$MENU";;
esac

